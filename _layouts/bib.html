---
---

{%- comment -%}
Template used by jekyll-scholar for each bibliography entry.
Configured via `scholar.bibliography_template: bib` in _config.yml.
Keeps a classic scientific look, but adds icon links, a collapsible
BibTeX block, and a hidden text blob for the JS filter.
{%- endcomment -%}

{%- comment -%}
Anchor so citation links (`href="#<key>"`) have a target.
{%- endcomment -%}
<a id="{{ entry.key }}"></a>

{%- comment -%} Build author list (First Last, First Last, ...) {%- endcomment -%}
{% if entry.author %}
  {% assign author_list = entry.author | split: " and " %}
{% elsif entry.editor %}
  {% assign author_list = entry.editor | split: " and " %}
{% else %}
  {% assign author_list = '' | split: '' %}
{% endif %}

{% assign authors = '' | split: '' %}
{% for author in author_list %}
  {% assign tmp = author | split: "," | reverse | join: " " %}
  {% assign authors = authors | push: tmp %}
{% endfor %}

{%- comment -%} Venue: journal / booktitle / school {%- endcomment -%}
{% assign venue = "" %}
{% if entry.journal %}
  {% assign venue = entry.journal %}
{% elsif entry.booktitle %}
  {% assign venue = entry.booktitle %}
{% elsif entry.school %}
  {% assign venue = entry.school %}
{% endif %}

{%- comment -%}
Main reference line â€“ full authors, full title, full venue, year.
{%- endcomment -%}

{% if authors.size > 0 %}
  {{ authors | array_to_sentence_string }}.
{% endif %}

{% if entry.title %}
  <i>{{ entry.title }}</i>.
{% endif %}

{% if venue %}
  {{ venue }}.
{% endif %}

{% if entry.year %}
  {{ entry.year }}.
{% endif %}

{%- comment -%}
Inline icon links: PDF / DOI / Code (BibTeX handled by <details> below)
Fields expected in .bib: pdf, doi, code
{%- endcomment -%}

<span class="pub-links">
  {% if entry.pdf %}
    <a href="{{ entry.pdf }}" target="_blank" title="PDF">
      <i class="fas fa-file-pdf"></i>
    </a>
  {% endif %}

  {% if entry.doi %}
    <a href="https://doi.org/{{ entry.doi }}" target="_blank" title="DOI">
      <i class="fas fa-tag"></i>
    </a>
  {% endif %}

  {% if entry.url %}
    <a href="{{ entry.url }}" target="_blank" title="URL">
      <i class="fas fa-external-link-alt"></i>
    </a>
  {% endif %}

  {% if entry.code %}
    <a href="{{ entry.code }}" target="_blank" title="Code">
      <i class="fas fa-code"></i>
    </a>
  {% endif %}
</span>

<details class="pub-bibtex">
  <summary class="pub-bibtex__summary">
    <span class="label">BibTeX</span>

    <button class="pub-bibtex__copy" type="button" title="Copy BibTeX">
      <i class="far fa-copy" aria-hidden="true"></i>
    </button>
  </summary>

  <pre><code>{{ entry.bibtex }}</code></pre>
</details>

{%- comment -%}
Hidden text used by your JS filter:
  var c = el.children;
  var tmp = c[c.length -1].value.toLowerCase();
So this input must stay the LAST child of <li>.
{%- endcomment -%}

<input type="hidden"
       value="{{ authors | array_to_sentence_string | escape }} {{ entry.title | escape }} {{ venue | escape }} {{ entry.year }}">
